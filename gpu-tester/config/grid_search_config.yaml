# VRAM Grid Search Configuration

# GPU
gpu:
  name: "L40S"
  vram_gb: 48

# Dataset
dataset:
  num_volumes: 67
  data_path: "/mnt/pve/ds_shared/data"
  dataset_enriched: "/mnt/pve/ds_shared/dataset_enriched_FINAL.json"
  train_test_split: "/mnt/pve/ds_shared/train_test_split.json"

# Grid Search Parameters
grid_search:
  # Spatial resolution (H Ã— W)
  spatial_resolutions: [32, 64, 128, 256, 512, 1024]
  
  # Depth (D)
  depth_sizes: [16, 24, 32, 48, 64]
  
  # Batch sizes
  batch_sizes: [4, 8, 12, 16, 20, 24, 32, 48, 64]
  
  # Models (24 total)
  models:
    # ResNet3D (5)
    - "ResNet3D-10"
    - "ResNet3D-18"
    - "ResNet3D-34"
    - "ResNet3D-50"
    - "ResNet3D-101"
    
    # EfficientNet3D (5)
    - "EfficientNet3D-B0"
    - "EfficientNet3D-B1"
    - "EfficientNet3D-B2"
    - "EfficientNet3D-B3"
    - "EfficientNet3D-B4"
    
    # ViT3D (4)
    - "ViT3D-Tiny"
    - "ViT3D-Small"
    - "ViT3D-Base"
    - "ViT3D-Large"
    
    # ConvNeXt3D (5)
    - "ConvNeXt3D-Tiny"
    - "ConvNeXt3D-Small"
    - "ConvNeXt3D-Base"
    - "ConvNeXt3D-Large"
    - "ConvNeXt3D-XLarge"
    
    # SE-ResNet3D (5)
    - "SE-ResNet3D-18"
    - "SE-ResNet3D-34"
    - "SE-ResNet3D-50"
    - "SE-ResNet3D-101"
    - "SE-ResNet3D-152"

# Output
output:
  results_dir: "results"
  results_file: "grid_search_results.json"
  results_csv: "grid_search_results.csv"
  best_config_file: "best_config.yaml"
  log_file: "grid_search.log"

# Simulation
simulation:
  use_synthetic_data: true
  enable_backward_pass: true
  num_warmup_iterations: 3
  num_test_iterations: 5
  clear_cache_between_tests: true

# Safety
safety:
  vram_safety_margin_gb: 2
  oom_retry_attempts: 0
  max_consecutive_cuda_errors: 10  # Stop if N consecutive CUDA errors (GPU health check)

# Optimization
optimization:
  use_mixed_precision: true
  mixed_precision_dtype: "float16"
  use_gradient_checkpointing: false
  compile_model: false

# Environment
environment:
  python_version: "3.10"
  conda_env: "py310"
